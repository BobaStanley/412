total_losses = sum(ifelse(result == "loss", 1, 0)),
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = mean(ifelse(result == "win", head(total_wins, -1), 0)),
avg_opponent_losses = mean(ifelse(result == "loss", head(total_losses, -1), 0))
) %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins)) %>%
head(1)
# Print the fighter with the highest win-loss ratio and average opponent wins
print(goat)
goat <- ufc_stats %>%
group_by(fighter) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = mean(ifelse(winner == "W", head(total_wins, -1), 0)),
avg_opponent_losses = mean(ifelse(winner == "L", head(total_losses, -1), 0))
) %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins)) %>%
head(1)
# Print the fighter with the highest win-loss ratio and average opponent wins
print(goat)
ufc_stats <- ufc_stats %>%
mutate(ppv_revenue = attendance * 59.99)
best_ppv_seller <- ufc_stats %>%
group_by(fighter) %>%
summarise(total_ppv_revenue = sum(ppv_revenue)) %>%
arrange(desc(total_ppv_revenue)) %>%
head(1)
# Print the fighter with the highest total PPV revenue
print(best_ppv_seller)
ufc_stats <- ufc_stats %>%
mutate(ppv_revenue_per_fight = (attendance * 59.99) / n())
best_ppv_seller_per_fight <- ufc_stats %>%
group_by(fighter) %>%
summarise(avg_ppv_revenue_per_fight = mean(ppv_revenue_per_fight)) %>%
arrange(desc(avg_ppv_revenue_per_fight)) %>%
head(1)
# Print the fighter with the highest average PPV revenue per fight
print(best_ppv_seller_per_fight)
ufc_stats <- ufc_stats %>%
mutate(ppv_revenue_per_fight = (attendance * 59.99) / n())
best_ppv_seller_per_fight <- ufc_stats %>%
group_by(fighter) %>%
summarise(avg_ppv_revenue_per_fight = mean(ppv_revenue_per_fight)) %>%
arrange(desc(avg_ppv_revenue_per_fight))
# Print the top fighter
print(best_ppv_seller_per_fight$fighter[1])
ufc_stats <- ufc_stats %>%
mutate(ppv_revenue = attendance * 59.99)
best_ppv_seller <- ufc_stats %>%
group_by(fighter) %>%
summarise(total_ppv_revenue = sum(ppv_revenue)) %>%
arrange(desc(total_ppv_revenue)) %>%
head(1)
# Print the fighter with the highest total PPV revenue
print(best_ppv_seller)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = mean(ifelse(winner == "W", head(total_wins, -1), 0)),
avg_opponent_losses = mean(ifelse(winner == "L", head(total_losses, -1), 0)),
total_fights = n()
) %>%
filter(total_fights >= 10)  # Filter for fighters with at least 10 fights
goat_filtered <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins)) %>%
head(1)
# Print the fighter with the highest win-loss ratio and average opponent wins
print(goat_filtered)
View(ufc_stats_filtered)
View(ufc_stats_filtered)
library(tidyverse)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n()
) %>%
filter(total_fights >= 10)  # Filter for fighters with at least 10 fights
ufc_stats_filtered <- ufc_stats_filtered %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = ifelse(total_fights > 1, mean(head(total_wins, -1)), 0),
avg_opponent_losses = ifelse(total_fights > 1, mean(head(total_losses, -1)), 0)
)
goat_filtered <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins)) %>%
head(1)
# Print the fighter with the highest win-loss ratio and average opponent wins
print(goat_filtered)
View(ufc_stats_filtered)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n()
) %>%
filter(total_fights >= 10)  # Filter for fighters with at least 10 fights
ufc_stats_filtered <- ufc_stats_filtered %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = ifelse(total_fights > 1, mean(head(total_wins, -1)), 0)
)
goat_filtered <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins)) %>%
head(1)
# Print the fighter with the highest win-loss ratio and average opponent wins
print(goat_filtered)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n()
) %>%
filter(total_fights >= 10)  # Filter for fighters with at least 10 fights
ufc_stats_filtered <- ufc_stats_filtered %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = ifelse(total_fights > 1, mean(head(total_wins, -1)), 0)
)
goat_filtered <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins)) %>%
head(1)
# Print the fighter with the highest win-loss ratio and average opponent wins
print(goat_filtered)
ufc_stats
ufc_stats %>% group_by(fighter) %>%
summarise(total_significant_strikes = sum(significant_strikes_landed)) %>%
arrange(-total_significant_strikes) %>%
head()
ufc_stats %>%
group_by(fighter) %>%
summarise(knockdown_rate = sum(knockdowns) / sum(significant_strikes_attempted)) %>%
arrange(desc(knockdown_rate)) %>%
head()
ufc_stats %>%
group_by(fighter) %>%
summarise(striking_efficiency = sum(significant_strikes_landed) / sum(significant_strikes_attempted)) %>%
arrange(desc(striking_efficiency)) %>%
head()
ufc_stats %>%
group_by(fighter) %>%
summarise(grappling_efficiency = sum(takedown_successful) / sum(takedown_attempted)) %>%
arrange(desc(grappling_efficiency)) %>%
head()
ufc_stats %>%
group_by(fighter) %>%
summarise(entertainment_score =
(knockdowns + significant_strikes_landed - significant_strikes_attempted + submission_attempt) / 4) %>%
arrange(desc(entertainment_score)) %>%
head()
ufc_stats %>%
group_by(fighter) %>%
summarise(ppv_impact_score =
(knockdowns + significant_strikes_landed + takedown_successful + (1 - takedown_rate) * 10) / 4 +
sum(attendance) / 1000) %>%
arrange(desc(ppv_impact_score)) %>%
head()
ufc_stats <- ufc_stats %>%
mutate(ppv_revenue_per_fight = (attendance * 59.99) / n())
best_ppv_seller_per_fight <- ufc_stats %>%
group_by(fighter) %>%
summarise(avg_ppv_revenue_per_fight = mean(ppv_revenue_per_fight)) %>%
arrange(desc(avg_ppv_revenue_per_fight))
# Print the top fighter
print(best_ppv_seller_per_fight$fighter[1])
ufc_stats <- ufc_stats %>%
mutate(ppv_revenue = attendance * 59.99)
best_ppv_seller <- ufc_stats %>%
group_by(fighter) %>%
summarise(total_ppv_revenue = sum(ppv_revenue)) %>%
arrange(desc(total_ppv_revenue)) %>%
head(1)
# Print the fighter with the highest total PPV revenue
print(best_ppv_seller)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n()
) %>%
filter(total_fights >= 10)  # Filter for fighters with at least 10 fights
ufc_stats_filtered <- ufc_stats_filtered %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = ifelse(total_fights > 1, mean(head(total_wins, -1)), 0)
)
goat_filtered <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins)) %>%
head(1)
# Print the fighter with the highest win-loss ratio and average opponent wins
print(goat_filtered)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n()
) %>%
filter(total_fights >= 10)  # Filter for fighters with at least 10 fights
ufc_stats_filtered <- ufc_stats_filtered %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = ifelse(total_fights > 1, mean(na.omit(head(total_wins, -1))), 0)
)
goat_filtered <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins)) %>%
head(1)
# Print the fighter with the highest win-loss ratio and average opponent wins
print(goat_filtered)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n()
) %>%
filter(total_fights >= 10)  # Filter for fighters with at least 10 fights
ufc_stats_filtered <- ufc_stats_filtered %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = ifelse(total_fights > 1, mean(na.omit(head(total_wins, -1))), 0)
)
ranked_fighters <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins))
# Print the ranked list of fighters
print(ranked_fighters)
View(ufc_stats_filtered)
View(ranked_fighters)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter, fight_date) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n_distinct(id)  # Counting distinct fights based on id
) %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = ifelse(total_fights > 1, mean(na.omit(head(total_wins, -1))), 0),
total_fights = sum(total_fights)  # Summing total_fights to account for repeated dates
)
ranked_fighters <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins))
# Print the ranked list of fighters
print(ranked_fighters)
View(ufc_stats)
ufc_stats
View(ranked_fighters)
View(ufc_stats)
View(ufc_stats)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter, fight_date) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n_distinct(id)  # Counting distinct fights based on id
) %>%
group_by(fighter) %>%
summarise(
total_fights = sum(total_fights)  # Summing total_fights to account for repeated dates
) %>%
filter(total_fights >= 10)  # Filter for fighters with at least 10 fights
ufc_stats_filtered <- ufc_stats_filtered %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = sum(winner == "W") / total_fights,
avg_opponent_wins = ifelse(total_fights > 1, mean(na.omit(lead(total_wins, default = 0))), 0)
)
View(ufc_stats_filtered)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter, fight_date) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n_distinct(id)  # Counting distinct fights based on id
) %>%
group_by(fighter) %>%
summarise(
total_fights = sum(total_fights)  # Summing total_fights to account for repeated dates
) %>%
filter(total_fights >= 10)  # Filter for fighters with at least 10 fights
ufc_stats_filtered <- ufc_stats_filtered %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = sum(winner == "W") / total_fights,
avg_opponent_wins = ifelse(total_fights > 1, mean(na.omit(lead(total_wins, default = 0))), 0)
)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter, fight_date) %>%
summarise(
total_wins = sum(result == "win"),
total_losses = sum(result == "loss"),
total_fights = n_distinct(id)
) %>%
group_by(fighter) %>%
summarise(
total_fights = sum(total_fights)
) %>%
filter(total_fights >= 10)
ufc_stats_filtered <- ufc_stats_filtered %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = sum(result == "win") / total_fights,
avg_opponent_wins = ifelse(total_fights > 1, mean(na.omit(lead(total_wins, default = 0))), 0)
)
View(ufc_stats_filtered)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter, fight_date) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n_distinct(id)  # Counting distinct fights based on id
) %>%
group_by(fighter) %>%
summarise(
total_fights = sum(total_fights)  # Summing total_fights to account for repeated dates
) %>%
filter(total_fights >= 10)  # Filter for fighters with at least 10 fights
ufc_stats_filtered <- ufc_stats_filtered %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = sum(winner == "W") / total_fights,
avg_opponent_wins = ifelse(total_fights > 1, mean(na.omit(lead(total_wins, default = 0))), 0)
)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter, fight_date) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n_distinct(id)  # Counting distinct fights based on id
) %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = ifelse(total_fights > 1, mean(na.omit(head(total_wins, -1))), 0),
total_fights = sum(total_fights)  # Summing total_fights to account for repeated dates
)
ranked_fighters <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins))
# Print the ranked list of fighters
print(ranked_fighters)
View(ufc_stats_filtered)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter, fight_date) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n_distinct(id)  # Counting distinct fights based on id
) %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = ifelse(total_fights > 1, mean(na.omit(head(total_wins, -1))), 0),
total_fights = sum(total_fights)  # Summing total_fights to account for repeated dates
) %>%
filter(total_fights >= 15)  # Filter for fighters with at least 15 fights
ranked_fighters <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins))
# Print the ranked list of fighters
print(ranked_fighters)
View(ufc_stats_filtered)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter, fight_date) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n_distinct(id)
) %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = ifelse(total_fights > 1, mean(na.omit(total_wins)), 0),
total_fights = sum(total_fights)
) %>%
filter(total_fights >= 15)
ranked_fighters <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins))
# Print the ranked list of fighters
print(ranked_fighters)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter, fight_date) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n_distinct(id)
) %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = ifelse(total_fights > 1, mean(na.omit(total_wins)), 0),
total_fights = sum(total_fights)
) %>%
filter(total_fights >= 15)
ranked_fighters <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins))
# Print the ranked list of fighters
print(ranked_fighters)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n_distinct(id)
) %>%
filter(total_fights >= 15)  # Adjust the minimum number of fights as needed
ufc_stats_filtered <- ufc_stats_filtered %>%
mutate(win_loss_ratio = total_wins / (total_wins + total_losses))
goat_filtered <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(total_wins)) %>%
head(1)
# Print the fighter with the best overall record
print(goat_filtered)
load("C:/Users/stanl/OneDrive/Documents/GitHub/412/FinalProject/ufc_stats.rda")
View(ufc_stats)
ufc_stats
ufc_stats %>% group_by(fighter) %>%
summarise(total_significant_strikes = sum(significant_strikes_landed)) %>%
arrange(-total_significant_strikes) %>%
head()
ufc_stats %>%
group_by(fighter) %>%
summarise(knockdown_rate = sum(knockdowns) / sum(significant_strikes_attempted)) %>%
arrange(desc(knockdown_rate)) %>%
head()
ufc_stats %>%
group_by(fighter) %>%
summarise(striking_efficiency = sum(significant_strikes_landed) / sum(significant_strikes_attempted)) %>%
arrange(desc(striking_efficiency)) %>%
head()
ufc_stats %>%
group_by(fighter) %>%
summarise(grappling_efficiency = sum(takedown_successful) / sum(takedown_attempted)) %>%
arrange(desc(grappling_efficiency)) %>%
head()
ufc_stats %>%
group_by(fighter) %>%
summarise(entertainment_score =
(knockdowns + significant_strikes_landed - significant_strikes_attempted + submission_attempt) / 4) %>%
arrange(desc(entertainment_score)) %>%
head()
ufc_stats %>%
group_by(fighter) %>%
summarise(ppv_impact_score =
(knockdowns + significant_strikes_landed + takedown_successful + (1 - takedown_rate) * 10) / 4 +
sum(attendance) / 1000) %>%
arrange(desc(ppv_impact_score)) %>%
head()
ufc_stats <- ufc_stats %>%
mutate(ppv_revenue_per_fight = (attendance * 59.99) / n())
best_ppv_seller_per_fight <- ufc_stats %>%
group_by(fighter) %>%
summarise(avg_ppv_revenue_per_fight = mean(ppv_revenue_per_fight)) %>%
arrange(desc(avg_ppv_revenue_per_fight))
# Print the top fighter
print(best_ppv_seller_per_fight$fighter[1])
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n_distinct(id)
) %>%
filter(total_fights >= 5)  # Adjust the minimum number of fights as needed
ufc_stats_filtered <- ufc_stats_filtered %>%
mutate(win_loss_ratio = total_wins / (total_wins + total_losses))
goat_filtered <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(total_wins)) %>%
head(1)
# Print the fighter with the best overall record
print(goat_filtered)
ufc_stats <- ufc_stats %>%
mutate(ppv_revenue = attendance * 59.99)
best_ppv_seller <- ufc_stats %>%
group_by(fighter) %>%
summarise(total_ppv_revenue = sum(ppv_revenue)) %>%
arrange(desc(total_ppv_revenue)) %>%
head(1)
# Print the fighter with the highest total PPV revenue
print(best_ppv_seller)
ufc_stats_filtered <- ufc_stats %>%
group_by(fighter, fight_date) %>%
summarise(
total_wins = sum(winner == "W"),
total_losses = sum(winner == "L"),
total_fights = n_distinct(id)
) %>%
group_by(fighter) %>%
summarise(
win_loss_ratio = total_wins / (total_wins + total_losses),
avg_opponent_wins = ifelse(total_fights > 1, mean(na.omit(total_wins)), 0),
total_fights = sum(total_fights)
) %>%
filter(total_fights >= 15)
ranked_fighters <- ufc_stats_filtered %>%
arrange(desc(win_loss_ratio), desc(avg_opponent_wins))
# Print the ranked list of fighters
print(ranked_fighters)
